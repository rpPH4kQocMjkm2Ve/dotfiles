#!/usr/bin/env bash
set -euo pipefail
. "${HOME}/.local/lib/bwrap-common.sh"

KRITA_CONF="${HOME}/.local/share/krita-config"
mkdir -p "$KRITA_CONF"

FILE_BINDS=(); ARGS=()
bwrap_resolve_files FILE_BINDS ARGS --bind "$@"

A=()
bwrap_gui_setup A
bwrap_bind_dir A bind \
    "${HOME}/.local/share/krita" \
    "${HOME}/.cache/krita" \
    "${HOME}/Pictures" \
    "${HOME}/Downloads"
A+=(--bind "$KRITA_CONF" "${HOME}/.config"
    "${FILE_BINDS[@]}")
bwrap_audio A
bwrap_fcitx A
A+=(--setenv QT_QPA_PLATFORM xcb --setenv QT_QPA_PLATFORMTHEME qt6ct)
bwrap_gui_finish A x11

exec bwrap "${A[@]}" -- /usr/bin/krita "${ARGS[@]}"
